<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Class: BuildingSync::WorkflowMaker
  
    &mdash; Documentation by YARD 0.9.26
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" />

<script type="text/javascript">
  pathId = "BuildingSync::WorkflowMaker";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (W)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../BuildingSync.html" title="BuildingSync (module)">BuildingSync</a></span></span>
     &raquo; 
    <span class="title">WorkflowMaker</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Class: BuildingSync::WorkflowMaker
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName"><span class='object_link'><a href="WorkflowMakerBase.html" title="BuildingSync::WorkflowMakerBase (class)">WorkflowMakerBase</a></span></span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next"><span class='object_link'><a href="WorkflowMakerBase.html" title="BuildingSync::WorkflowMakerBase (class)">WorkflowMakerBase</a></span></li>
          
            <li class="next">BuildingSync::WorkflowMaker</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/buildingsync/makers/workflow_maker.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>base class for objects that will configure workflows based on building sync
files</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="Translator.html" title="BuildingSync::Translator (class)">Translator</a></span></p>
</div>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#cleanup_larger_files-instance_method" title="#cleanup_larger_files (instance method)">#<strong>cleanup_larger_files</strong>(osw_dir)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>cleanup larger files.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#configure_workflow_for_scenario-instance_method" title="#configure_workflow_for_scenario (instance method)">#<strong>configure_workflow_for_scenario</strong>(base_workflow, scenario)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Based on the MeasureIDs defined by the Scenario, configure the workflow
provided using the default measure arguments defined by the
lib/buildingsync/makers/workflow_maker.json.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deep_copy_workflow-instance_method" title="#deep_copy_workflow (instance method)">#<strong>deep_copy_workflow</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Creates a deep copy of the @workflow be serializing and reloading with
JSON.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#gather_results-instance_method" title="#gather_results (instance method)">#<strong>gather_results</strong>(year_val = Date.today.year, baseline_only = false)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>gather results for all CB Modeled and POM Scenarios, including both annual
and monthly results - ResourceUse and AllResourceTotal elements are added
to the Scenario as part of this process - ResourceUse - holds consumption
information about a specific resource / fuel (Electricity, Natural gas,
etc.) - AllResourceTotal - holds total site and source energy consumption
information.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_available_measures_hash-instance_method" title="#get_available_measures_hash (instance method)">#<strong>get_available_measures_hash</strong>  &#x21d2; hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>gets all available measures across all measure directories.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_facility-instance_method" title="#get_facility (instance method)">#<strong>get_facility</strong>  &#x21d2; BuildingSync::Facility </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the facility object from this workflow.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_failed_scenarios-instance_method" title="#get_failed_scenarios (instance method)">#<strong>get_failed_scenarios</strong>  &#x21d2; Array&lt;BuildingSync::Scenario&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get failed scenarios.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_measure_directories_array-instance_method" title="#get_measure_directories_array (instance method)">#<strong>get_measure_directories_array</strong>  &#x21d2; array </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>collect all measure directories that contain measures needed for BldgSync.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_measure_type-instance_method" title="#get_measure_type (instance method)">#<strong>get_measure_type</strong>(measure_dir_name)  &#x21d2; String </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>gets the measure type of a measure given its directory - looking up the
measure type in the measure.xml file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_model-instance_method" title="#get_model (instance method)">#<strong>get_model</strong>  &#x21d2; OpenStudio::Model </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get model.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_scenarios-instance_method" title="#get_scenarios (instance method)">#<strong>get_scenarios</strong>  &#x21d2; Array&lt;BuildingSync::Scenario&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get scenario elements.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_space_types-instance_method" title="#get_space_types (instance method)">#<strong>get_space_types</strong>  &#x21d2; Vector&lt;OpenStudio::Model::SpaceType&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the space types of the facility.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_workflow-instance_method" title="#get_workflow (instance method)">#<strong>get_workflow</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>get the current workflow.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">#<strong>initialize</strong>(doc, ns)  &#x21d2; WorkflowMaker </a>
    

    
  </span>
  
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>initialize - load workflow json file and add necessary measure paths.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#insert_measure_into_workflow-instance_method" title="#insert_measure_into_workflow (instance method)">#<strong>insert_measure_into_workflow</strong>(measure_goal_type, measure_dir_name, relative_position = 0, args_hash = {})  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>inserts any measure.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#measures_exist%3F-instance_method" title="#measures_exist? (instance method)">#<strong>measures_exist?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>iterate over the current measure list in the workflow and check if they are
available at the referenced measure directories.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepare_final_xml-instance_method" title="#prepare_final_xml (instance method)">#<strong>prepare_final_xml</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>writes the parameters determined during processing back to the BldgSync XML
file.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#purge_skipped_from_workflow-instance_method" title="#purge_skipped_from_workflow (instance method)">#<strong>purge_skipped_from_workflow</strong>(workflow)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Removes unused measures from a workflow, where __SKIP__ == true copy is
made and the measures are configured for the specific scenario KAF:
reworked to only delete measures with an explicit __SKIP__ == true 
(sometimes measure don&#39;t have a skip at all, assume we want to keep
those).</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#read_xml-instance_method" title="#read_xml (instance method)">#<strong>read_xml</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run_osws-instance_method" title="#run_osws (instance method)">#<strong>run_osws</strong>(output_dir, only_cb_modeled = false, runner_options = { run_simulations: true, verbose: false, num_parallel: 7, max_to_run: Float::INFINITY })  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>run osws - running all scenario simulations.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_argument_detail-instance_method" title="#set_argument_detail (instance method)">#<strong>set_argument_detail</strong>(workflow, argument, measure_dir_name, measure_name)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>TODO: Update this as I believe no longer will work as expected, keys being
searched for       by the @<a href="'key'">facility_xml</a> don&#39;t make
sense.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#setup_and_sizing_run-instance_method" title="#setup_and_sizing_run (instance method)">#<strong>setup_and_sizing_run</strong>(dir, epw_file_path, standard_to_be_used, ddy_file = nil)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>generate the baseline model as osm model.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_osw-instance_method" title="#write_osw (instance method)">#<strong>write_osw</strong>(main_output_dir, scenario)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Write an OSW for the provided scenario.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#write_osws-instance_method" title="#write_osws (instance method)">#<strong>write_osws</strong>(main_output_dir, only_cb_modeled = false)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>write workflows for scenarios into osw files.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  
  <h3 class="inherited">Methods inherited from <span class='object_link'><a href="WorkflowMakerBase.html" title="BuildingSync::WorkflowMakerBase (class)">WorkflowMakerBase</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="WorkflowMakerBase.html#add_measure_path-instance_method" title="BuildingSync::WorkflowMakerBase#add_measure_path (method)">#add_measure_path</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#add_new_measure-instance_method" title="BuildingSync::WorkflowMakerBase#add_new_measure (method)">#add_new_measure</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#clear_all_measures-instance_method" title="BuildingSync::WorkflowMakerBase#clear_all_measures (method)">#clear_all_measures</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#get_prefix-instance_method" title="BuildingSync::WorkflowMakerBase#get_prefix (method)">#get_prefix</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#save_xml-instance_method" title="BuildingSync::WorkflowMakerBase#save_xml (method)">#save_xml</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#set_measure_argument-instance_method" title="BuildingSync::WorkflowMakerBase#set_measure_argument (method)">#set_measure_argument</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#set_measure_path-instance_method" title="BuildingSync::WorkflowMakerBase#set_measure_path (method)">#set_measure_path</a></span>, <span class='object_link'><a href="WorkflowMakerBase.html#set_measure_paths-instance_method" title="BuildingSync::WorkflowMakerBase#set_measure_paths (method)">#set_measure_paths</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <h3 class="signature first" id="initialize-instance_method">
  
    #<strong>initialize</strong>(doc, ns)  &#x21d2; <tt><span class='object_link'><a href="" title="BuildingSync::WorkflowMaker (class)">WorkflowMaker</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>initialize - load workflow json file and add necessary measure paths</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>doc</span>
      
      
        <span class='type'>(<tt>REXML::Document</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>ns</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 57</span>

<span class='kw'>def</span> <span class='id identifier rubyid_initialize'>initialize</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_ns'>ns</span><span class='rparen'>)</span>
  <span class='kw'>super</span><span class='lparen'>(</span><span class='id identifier rubyid_doc'>doc</span><span class='comma'>,</span> <span class='id identifier rubyid_ns'>ns</span><span class='rparen'>)</span>

  <span class='ivar'>@facility_xml</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='ivar'>@facility</span> <span class='op'>=</span> <span class='kw'>nil</span>

  <span class='comment'># TODO: Be consistent in symbolizing names in hashes or not
</span>  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../top-level-namespace.html#PHASE_0_BASE_OSW_FILE_PATH-constant" title="PHASE_0_BASE_OSW_FILE_PATH (constant)">PHASE_0_BASE_OSW_FILE_PATH</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='ivar'>@workflow</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='const'><span class='object_link'><a href="../top-level-namespace.html#WORKFLOW_MAKER_JSON_FILE_PATH-constant" title="WORKFLOW_MAKER_JSON_FILE_PATH (constant)">WORKFLOW_MAKER_JSON_FILE_PATH</a></span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
    <span class='ivar'>@workflow_maker_json</span> <span class='op'>=</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='comma'>,</span> <span class='label'>symbolize_names:</span> <span class='kw'>true</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Add all of the measure directories from the extension gems
</span>  <span class='comment'># into the @workflow, then check they exist
</span>  <span class='id identifier rubyid_set_measure_paths'>set_measure_paths</span><span class='lparen'>(</span><span class='id identifier rubyid_get_measure_directories_array'>get_measure_directories_array</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_measures_exist?'>measures_exist?</span>
  <span class='id identifier rubyid_read_xml'>read_xml</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="cleanup_larger_files-instance_method">
  
    #<strong>cleanup_larger_files</strong>(osw_dir)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>cleanup larger files</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>osw_dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


556
557
558
559
560
561
562
563
564
565
566
567
568
569</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 556</span>

<span class='kw'>def</span> <span class='id identifier rubyid_cleanup_larger_files'>cleanup_larger_files</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eplusout.sql</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_f'>rm_f</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>data_point.zip</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_f'>rm_f</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_path'>path</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>eplusout.eso</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_f'>rm_f</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*create_typical_building_from_model*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_dir'>osw_dir</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*create_typical_building_from_model*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_path'>path</span><span class='op'>|</span>
    <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_rm_rf'>rm_rf</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_path'>path</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="configure_workflow_for_scenario-instance_method">
  
    #<strong>configure_workflow_for_scenario</strong>(base_workflow, scenario)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Based on the MeasureIDs defined by the Scenario, configure the workflow
provided using the default measure arguments defined by the
lib/buildingsync/makers/workflow_maker.json</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>base_workflow</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Hash map of the @workflow.  DO NOT  use @workflow directly, should be a
deep clone</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scenario</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a Scenario object</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 283</span>

<span class='kw'>def</span> <span class='id identifier rubyid_configure_workflow_for_scenario'>configure_workflow_for_scenario</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_scenario'>scenario</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>true</span>

  <span class='id identifier rubyid_num_measures'>num_measures</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_get_measure_ids'>get_measure_ids</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_measure_id'>measure_id</span><span class='op'>|</span>
    <span class='id identifier rubyid_measure'>measure</span> <span class='op'>=</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_measures'>measures</span><span class='period'>.</span><span class='id identifier rubyid_find'>find</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_m'>m</span><span class='op'>|</span> <span class='id identifier rubyid_m'>m</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span> <span class='op'>==</span> <span class='id identifier rubyid_measure_id'>measure_id</span> <span class='rbrace'>}</span>
    <span class='id identifier rubyid_current_num_measure'>current_num_measure</span> <span class='op'>=</span> <span class='id identifier rubyid_num_measures'>num_measures</span>

    <span class='id identifier rubyid_sym_to_find'>sym_to_find</span> <span class='op'>=</span> <span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_text'>xget_text</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SystemCategoryAffected</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Measure ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not define a SystemCategoryAffected.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_sym_to_find'>sym_to_find</span> <span class='op'>=</span> <span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
    <span class='kw'>end</span>

    <span class='comment'># &#39;Other HVAC&#39; or &#39;Cooling System&#39; as examples
</span>    <span class='id identifier rubyid_categories_found'>categories_found</span> <span class='op'>=</span> <span class='ivar'>@workflow_maker_json</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_categories_found'>categories_found</span>
      <span class='id identifier rubyid_m_name'>m_name</span> <span class='op'>=</span> <span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_name'>xget_name</span>

      <span class='kw'>if</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Measure ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> does not have a MeasureName defined.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='kw'>else</span>
        <span class='id identifier rubyid_m_name'>m_name</span> <span class='op'>=</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
      <span class='kw'>end</span>

      <span class='comment'># Where standardized measure names have not been adopted as enumerations
</span>      <span class='comment'># in the BuildingSync Schema, a &lt;MeasureName&gt;Other&lt;/MeasureName&gt; is used
</span>      <span class='comment'># and the actual measure name added
</span>      <span class='kw'>if</span> <span class='id identifier rubyid_m_name'>m_name</span> <span class='op'>==</span> <span class='symbol'>:Other</span>
        <span class='id identifier rubyid_m_name'>m_name</span> <span class='op'>=</span> <span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_text'>xget_text</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>CustomMeasureName</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
          <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Measure ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> has a MeasureName of &#39;Other&#39; but does not have a CustomMeasureName defined.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='kw'>else</span>
          <span class='id identifier rubyid_m_name'>m_name</span> <span class='op'>=</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_measure_found'>measure_found</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='ivar'>@workflow_maker_json</span><span class='lbracket'>[</span><span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_category'>category</span><span class='op'>|</span>
        <span class='comment'># m_name is, for example: &#39;Replace HVAC system type to VRF&#39;
</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_category'>category</span><span class='lbracket'>[</span><span class='id identifier rubyid_m_name'>m_name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='id identifier rubyid_measure_found'>measure_found</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span> <span class='op'>=</span> <span class='id identifier rubyid_category'>category</span><span class='lbracket'>[</span><span class='id identifier rubyid_m_name'>m_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:measure_dir_name</span><span class='rbracket'>]</span>
          <span class='id identifier rubyid_num_measures'>num_measures</span> <span class='op'>+=</span> <span class='int'>1</span>
          <span class='id identifier rubyid_category'>category</span><span class='lbracket'>[</span><span class='id identifier rubyid_m_name'>m_name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='symbol'>:arguments</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_argument'>argument</span><span class='op'>|</span>
            <span class='comment'># Certain arguments are only applied under specific conditions
</span>            <span class='comment'>#
</span>            <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
              <span class='id identifier rubyid_set_argument_detail'>set_argument_detail</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_argument'>argument</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='comma'>,</span> <span class='id identifier rubyid_m_name'>m_name</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rparen'>)</span>
            <span class='kw'>else</span>
              <span class='id identifier rubyid_set_measure_argument'>set_measure_argument</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='comma'>,</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span><span class='rparen'>)</span>
            <span class='kw'>end</span>
          <span class='kw'>end</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_measure_found'>measure_found</span>
        <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not find measure &#39;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_m_name'>m_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>&#39; under category </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_sym_to_find'>sym_to_find</span><span class='embexpr_end'>}</span><span class='tstring_content'> in workflow_maker.json.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>else</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Category: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_text'>xget_text</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>SystemCategoryAffected</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_content'> not found in workflow_maker.json.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_current_num_measure'>current_num_measure</span> <span class='op'>==</span> <span class='id identifier rubyid_num_measures'>num_measures</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Measure ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure'>measure</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'> could not be processed!</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># ensure that we didn&#39;t miss any measures by accident
</span>  <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.configure_workflow_for_scenario</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_get_measure_ids'>get_measure_ids</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'> measures expected, </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_num_measures'>num_measures</span><span class='embexpr_end'>}</span><span class='tstring_content'> resolved,  expected measure_ids = </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_get_measure_ids'>get_measure_ids</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_num_measures'>num_measures</span> <span class='op'>!=</span> <span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_get_measure_ids'>get_measure_ids</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_successful'>successful</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deep_copy_workflow-instance_method">
  
    #<strong>deep_copy_workflow</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Creates a deep copy of the @workflow be serializing and reloading with JSON</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a new workflow object</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


514
515
516</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 514</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deep_copy_workflow'>deep_copy_workflow</span>
  <span class='kw'>return</span> <span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_load'>load</span><span class='lparen'>(</span><span class='const'>JSON</span><span class='period'>.</span><span class='id identifier rubyid_generate'>generate</span><span class='lparen'>(</span><span class='ivar'>@workflow</span><span class='rparen'>)</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="gather_results-instance_method">
  
    #<strong>gather_results</strong>(year_val = Date.today.year, baseline_only = false)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>gather results for all CB Modeled and POM Scenarios, including both annual
and monthly results</p>
<ul><li>
<p>ResourceUse and AllResourceTotal elements are added to the Scenario as part
of this process</p>
</li><li>
<p>ResourceUse - holds consumption information about a specific resource /
fuel (Electricity, Natural gas, etc.)</p>
</li><li>
<p>AllResourceTotal - holds total site and source energy consumption
information</p>
</li></ul>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>year_val</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>Date.today.year</tt>)</em>
      
      
    </li>
  
    <li>
      
        <span class='name'>baseline_only</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


578
579
580
581
582
583
584
585
586
587
588</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 578</span>

<span class='kw'>def</span> <span class='id identifier rubyid_gather_results'>gather_results</span><span class='lparen'>(</span><span class='id identifier rubyid_year_val'>year_val</span> <span class='op'>=</span> <span class='const'>Date</span><span class='period'>.</span><span class='id identifier rubyid_today'>today</span><span class='period'>.</span><span class='id identifier rubyid_year'>year</span><span class='comma'>,</span> <span class='id identifier rubyid_baseline_only'>baseline_only</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='comment'># Gather results for the Current Building Modeled (Baseline) Scenario
</span>  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_cb_modeled'>cb_modeled</span><span class='period'>.</span><span class='id identifier rubyid_os_gather_results'>os_gather_results</span><span class='lparen'>(</span><span class='id identifier rubyid_year_val'>year_val</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_baseline_only'>baseline_only</span>
    <span class='comment'># Gather results for the Package of Measures scenarios
</span>    <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_poms'>poms</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_scenario'>scenario</span><span class='op'>|</span>
      <span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_os_gather_results'>os_gather_results</span><span class='lparen'>(</span><span class='id identifier rubyid_year_val'>year_val</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_available_measures_hash-instance_method">
  
    #<strong>get_available_measures_hash</strong>  &#x21d2; <tt>hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>gets all available measures across all measure directories</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>Looks as follows [measure_name1, mn2, etc.],
path_to_measure_dir_2: []</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


184
185
186
187
188
189
190
191
192</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 184</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_available_measures_hash'>get_available_measures_hash</span>
  <span class='id identifier rubyid_measures_hash'>measures_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_get_measure_directories_array'>get_measure_directories_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='op'>|</span>
    <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_chdir'>chdir</span><span class='lparen'>(</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='rparen'>)</span> <span class='kw'>do</span>
      <span class='id identifier rubyid_measures_hash'>measures_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>*</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_select'>select</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_f'>f</span><span class='op'>|</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_directory?'>directory?</span> <span class='id identifier rubyid_f'>f</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_measures_hash'>measures_hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_facility-instance_method">
  
    #<strong>get_facility</strong>  &#x21d2; <tt><span class='object_link'><a href="Facility.html" title="BuildingSync::Facility (class)">BuildingSync::Facility</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the facility object from this workflow</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Facility.html" title="BuildingSync::Facility (class)">BuildingSync::Facility</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>facility</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 101</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_facility'>get_facility</span>
  <span class='kw'>return</span> <span class='ivar'>@facility</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_failed_scenarios-instance_method">
  
    #<strong>get_failed_scenarios</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get failed scenarios</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


546
547
548
549
550
551
552</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 546</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_failed_scenarios'>get_failed_scenarios</span>
  <span class='id identifier rubyid_failed'>failed</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_scenarios'>scenarios</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_scenario'>scenario</span><span class='op'>|</span>
    <span class='id identifier rubyid_failed'>failed</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_scenario'>scenario</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_simulation_success?'>simulation_success?</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_failed'>failed</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_measure_directories_array-instance_method">
  
    #<strong>get_measure_directories_array</strong>  &#x21d2; <tt>array</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>collect all measure directories that contain measures needed for BldgSync</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>array</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>of measure dirs</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 196</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_measure_directories_array'>get_measure_directories_array</span>
  <span class='id identifier rubyid_common_measures_instance'>common_measures_instance</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>CommonMeasures</span><span class='op'>::</span><span class='const'>Extension</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_model_articulation_instance'>model_articulation_instance</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>ModelArticulation</span><span class='op'>::</span><span class='const'>Extension</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_ee_measures_instance'>ee_measures_instance</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>EeMeasures</span><span class='op'>::</span><span class='const'>Extension</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
  <span class='id identifier rubyid_bldg_sync_instance'>bldg_sync_instance</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../BuildingSync.html" title="BuildingSync (module)">BuildingSync</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Extension.html" title="BuildingSync::Extension (class)">Extension</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Extension.html#initialize-instance_method" title="BuildingSync::Extension#initialize (method)">new</a></span></span>
  <span class='kw'>return</span> <span class='lbracket'>[</span><span class='id identifier rubyid_common_measures_instance'>common_measures_instance</span><span class='period'>.</span><span class='id identifier rubyid_measures_dir'>measures_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_model_articulation_instance'>model_articulation_instance</span><span class='period'>.</span><span class='id identifier rubyid_measures_dir'>measures_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_bldg_sync_instance'>bldg_sync_instance</span><span class='period'>.</span><span class='id identifier rubyid_measures_dir'>measures_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_ee_measures_instance'>ee_measures_instance</span><span class='period'>.</span><span class='id identifier rubyid_measures_dir'>measures_dir</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_measure_type-instance_method">
  
    #<strong>get_measure_type</strong>(measure_dir_name)  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>gets the measure type of a measure given its directory - looking up the
measure type in the measure.xml file</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>measure_dir_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the directory name for the measure, as it appears in any of the gems, i.e.
<a href="measure_dir_name">openstudio-common-measures-gem/lib/measures/</a></p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 259</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_measure_type'>measure_type</span> <span class='op'>=</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_get_measure_directories_array'>get_measure_directories_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='op'>|</span>
    <span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>if</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_measure_xml_doc'>measure_xml_doc</span> <span class='op'>=</span> <span class='kw'>nil</span>
      <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_open'>open</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/measure.xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>r</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_file'>file</span><span class='op'>|</span>
        <span class='id identifier rubyid_measure_xml_doc'>measure_xml_doc</span> <span class='op'>=</span> <span class='const'>REXML</span><span class='op'>::</span><span class='const'>Document</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_file'>file</span><span class='rparen'>)</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_measure_xml_doc'>measure_xml_doc</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>/measure/attributes/attribute</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_attribute'>attribute</span><span class='op'>|</span>
        <span class='id identifier rubyid_attribute_name'>attribute_name</span> <span class='op'>=</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_attribute_name'>attribute_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Measure Type</span><span class='tstring_end'>&#39;</span></span>
          <span class='id identifier rubyid_measure_type'>measure_type</span> <span class='op'>=</span> <span class='id identifier rubyid_attribute'>attribute</span><span class='period'>.</span><span class='id identifier rubyid_elements'>elements</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>value</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_text'>text</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_measure_type'>measure_type</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_model-instance_method">
  
    #<strong>get_model</strong>  &#x21d2; <tt>OpenStudio::Model</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get model</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>OpenStudio::Model</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>model</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


113
114
115</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 113</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_model'>get_model</span>
  <span class='kw'>return</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_get_model'>get_model</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_scenarios-instance_method">
  
    #<strong>get_scenarios</strong>  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get scenario elements</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


125
126
127</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 125</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_scenarios'>get_scenarios</span>
  <span class='kw'>return</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_scenarios'>scenarios</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_space_types-instance_method">
  
    #<strong>get_space_types</strong>  &#x21d2; <tt>Vector&lt;OpenStudio::Model::SpaceType&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the space types of the facility</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Vector&lt;OpenStudio::Model::SpaceType&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>vector of space types</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_space_types'>get_space_types</span>
  <span class='kw'>return</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_get_space_types'>get_space_types</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="get_workflow-instance_method">
  
    #<strong>get_workflow</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>get the current workflow</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 119</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_workflow'>get_workflow</span>
  <span class='kw'>return</span> <span class='ivar'>@workflow</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="insert_measure_into_workflow-instance_method">
  
    #<strong>insert_measure_into_workflow</strong>(measure_goal_type, measure_dir_name, relative_position = 0, args_hash = {})  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>inserts any measure.  traverses through the measures available in the
included extensions (common measures, model articulation, etc.) to find the
<a href="measure_dir">lib/measures/</a> specified. It is inserted at the
relative position according to its type</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>measure_goal_type</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>one of: &#39;EnergyPlusMeasure&#39;, &#39;ReportingMeasure&#39;, or
&#39;ModelMeasure&#39;</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>measure_dir_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the directory name for the measure, as it appears in any of the gems, i.e.
<a href="measure_dir_name">openstudio-common-measures-gem/lib/measures/</a></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>relative_position</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>the position where the measure should be inserted with respect to the
measure_goal_type</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>args_hash</span>
      
      
        <span class='type'>(<tt>hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 212</span>

<span class='kw'>def</span> <span class='id identifier rubyid_insert_measure_into_workflow'>insert_measure_into_workflow</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='comma'>,</span> <span class='id identifier rubyid_relative_position'>relative_position</span> <span class='op'>=</span> <span class='int'>0</span><span class='comma'>,</span> <span class='id identifier rubyid_args_hash'>args_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_successfully_added'>successfully_added</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_count'>count</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># count for all of the measures, regardless of the type
</span>  <span class='id identifier rubyid_measure_type_count'>measure_type_count</span> <span class='op'>=</span> <span class='int'>0</span> <span class='comment'># count of measures specific to the measure_goal_type
</span>  <span class='id identifier rubyid_measure_type_found'>measure_type_found</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='id identifier rubyid_new_step'>new_step</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='id identifier rubyid_new_step'>new_step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>measure_dir_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span>
  <span class='id identifier rubyid_new_step'>new_step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_args_hash'>args_hash</span>
  <span class='kw'>if</span> <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='id identifier rubyid_new_step'>new_step</span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successfully_added'>successfully_added</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='kw'>else</span>
    <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_step'>step</span><span class='op'>|</span>
      <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span> <span class='op'>=</span> <span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>measure_dir_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_measure_type'>measure_type</span> <span class='op'>=</span> <span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.insert_measure_into_workflow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>measure: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> with type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_type'>measure_type</span><span class='embexpr_end'>}</span><span class='tstring_content'> found</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_measure_type'>measure_type</span> <span class='op'>==</span> <span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span>
        <span class='id identifier rubyid_measure_type_found'>measure_type_found</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_measure_type_count'>measure_type_count</span> <span class='op'>==</span> <span class='id identifier rubyid_relative_position'>relative_position</span>
          <span class='comment'># insert measure here
</span>          <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.insert_measure_into_workflow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>inserting measure with type (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>) at position </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> and dir: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> and type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
          <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>inserting measure with type (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>) at position </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> and dir: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> and type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
          <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span><span class='comma'>,</span> <span class='id identifier rubyid_new_step'>new_step</span><span class='rparen'>)</span>
          <span class='id identifier rubyid_successfully_added'>successfully_added</span> <span class='op'>=</span> <span class='kw'>true</span>
          <span class='kw'>break</span>
        <span class='kw'>end</span>
        <span class='id identifier rubyid_measure_type_count'>measure_type_count</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>elsif</span> <span class='id identifier rubyid_measure_type_found'>measure_type_found</span>
        <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.insert_measure_into_workflow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>inserting measure with type (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>)at position </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> and dir: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> and type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>inserting measure with type (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>) at position </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> and dir: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> and type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
        <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_insert'>insert</span><span class='lparen'>(</span><span class='id identifier rubyid_count'>count</span> <span class='op'>-</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_new_step'>new_step</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_successfully_added'>successfully_added</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
      <span class='id identifier rubyid_count'>count</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_successfully_added'>successfully_added</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMakerPhaseZero.insert_measure_into_workflow</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CANNOT insert measure with type (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_goal_type'>measure_goal_type</span><span class='embexpr_end'>}</span><span class='tstring_content'>) at position </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_count'>count</span><span class='embexpr_end'>}</span><span class='tstring_content'> and dir: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> and type: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_measure_type'>get_measure_type</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='rparen'>)</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_successfully_added'>successfully_added</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="measures_exist?-instance_method">
  
    #<strong>measures_exist?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>iterate over the current measure list in the workflow and check if they are
available at the referenced measure directories</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 155</span>

<span class='kw'>def</span> <span class='id identifier rubyid_measures_exist?'>measures_exist?</span>
  <span class='id identifier rubyid_all_measures_found'>all_measures_found</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='id identifier rubyid_number_measures_found'>number_measures_found</span> <span class='op'>=</span> <span class='int'>0</span>
  <span class='ivar'>@workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_step'>step</span><span class='op'>|</span>
    <span class='id identifier rubyid_measure_is_valid'>measure_is_valid</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span> <span class='op'>=</span> <span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>measure_dir_name</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_get_measure_directories_array'>get_measure_directories_array</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='op'>|</span>
      <span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_potential_measure_path'>potential_measure_path</span><span class='embexpr_end'>}</span><span class='tstring_content'>/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
      <span class='kw'>if</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span><span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span><span class='rparen'>)</span>
        <span class='id identifier rubyid_measure_is_valid'>measure_is_valid</span> <span class='op'>=</span> <span class='kw'>true</span>
        <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.measures_exist?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Measure: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'> found at: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_full_path'>measure_dir_full_path</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
        <span class='id identifier rubyid_number_measures_found'>number_measures_found</span> <span class='op'>+=</span> <span class='int'>1</span>
        <span class='kw'>break</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_measure_is_valid'>measure_is_valid</span>
      <span class='id identifier rubyid_all_measures_found'>all_measures_found</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.measures_exist?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CANNOT find measure with name (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>) in any of the measure paths  </span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_all_measures_found'>all_measures_found</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.measures_exist?</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Total measures found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_number_measures_found'>number_measures_found</span><span class='embexpr_end'>}</span><span class='tstring_content'>. All measures defined by @workflow found.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Total measures found: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_number_measures_found'>number_measures_found</span><span class='embexpr_end'>}</span><span class='tstring_content'>. All measures defined by @workflow found.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_all_measures_found'>all_measures_found</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="prepare_final_xml-instance_method">
  
    #<strong>prepare_final_xml</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>writes the parameters determined during processing back to the BldgSync XML
file</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


143
144
145</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 143</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prepare_final_xml'>prepare_final_xml</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_prepare_final_xml'>prepare_final_xml</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="purge_skipped_from_workflow-instance_method">
  
    #<strong>purge_skipped_from_workflow</strong>(workflow)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Removes unused measures from a workflow, where __SKIP__ == true copy is
made and the measures are configured for the specific scenario KAF:
reworked to only delete measures with an explicit __SKIP__ == true 
(sometimes measure don&#39;t have a skip at all, assume we want to keep
those)</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>workflow</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash of the openstudio workflow, typically after a deep</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 523</span>

<span class='kw'>def</span> <span class='id identifier rubyid_purge_skipped_from_workflow'>purge_skipped_from_workflow</span><span class='lparen'>(</span><span class='id identifier rubyid_workflow'>workflow</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_non_skipped'>non_skipped</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_workflow'>workflow</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_workflow'>workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_workflow'>workflow</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_workflow'>workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_step'>step</span><span class='op'>|</span>
      <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_step'>step</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
        <span class='kw'>if</span> <span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
          <span class='comment'># no arguments, keep anyway
</span>          <span class='id identifier rubyid_non_skipped'>non_skipped</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>__SKIP__</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>__SKIP__</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='kw'>false</span>
          <span class='comment'># skip is set to false, keep
</span>          <span class='id identifier rubyid_non_skipped'>non_skipped</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
        <span class='kw'>elsif</span> <span class='op'>!</span><span class='id identifier rubyid_step'>step</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>arguments</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_key?'>key?</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>__SKIP__</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
          <span class='comment'># no &quot;SKIP&quot; argument, keep anyway
</span>          <span class='id identifier rubyid_non_skipped'>non_skipped</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_step'>step</span>
        <span class='kw'>end</span>
      <span class='kw'>end</span> 
    <span class='kw'>end</span>
    <span class='id identifier rubyid_workflow'>workflow</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>steps</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_non_skipped'>non_skipped</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="read_xml-instance_method">
  
    #<strong>read_xml</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94
95
96
97</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 79</span>

<span class='kw'>def</span> <span class='id identifier rubyid_read_xml'>read_xml</span>
  <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span> <span class='op'>=</span> <span class='ivar'>@doc</span><span class='period'>.</span><span class='id identifier rubyid_get_elements'>get_elements</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_prefix'>get_prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>BuildingSync/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_prefix'>get_prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>Facilities/</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_get_prefix'>get_prefix</span><span class='embexpr_end'>}</span><span class='tstring_content'>Facility</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># Raise errors for zero or multiple Facilities.  Not supported at this time.
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.populate_facility_report_and_scenarios</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>There are no Facility elements in your BuildingSync file.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>There are no Facility elements in your BuildingSync file.</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>&gt;</span> <span class='int'>1</span>
    <span class='ivar'>@facility_xml</span> <span class='op'>=</span> <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Warn</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.populate_facility_report_and_scenarios</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>There are more than one (</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='embexpr_end'>}</span><span class='tstring_content'>) Facility elements in your BuildingSync file. Only the first Facility will be considered (ID: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@facility_xml</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>else</span>
    <span class='ivar'>@facility_xml</span> <span class='op'>=</span> <span class='id identifier rubyid_facility_xml_temp'>facility_xml_temp</span><span class='period'>.</span><span class='id identifier rubyid_first'>first</span>
  <span class='kw'>end</span>

  <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Info</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.read_xml</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Setting up workflow for Facility ID: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@facility_xml</span><span class='period'>.</span><span class='id identifier rubyid_attributes'>attributes</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ID</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>

  <span class='comment'># Initialize Facility object
</span>  <span class='ivar'>@facility</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../BuildingSync.html" title="BuildingSync (module)">BuildingSync</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Facility.html" title="BuildingSync::Facility (class)">Facility</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="Facility.html#initialize-instance_method" title="BuildingSync::Facility#initialize (method)">new</a></span></span><span class='lparen'>(</span><span class='ivar'>@facility_xml</span><span class='comma'>,</span> <span class='ivar'>@ns</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="run_osws-instance_method">
  
    #<strong>run_osws</strong>(output_dir, only_cb_modeled = false, runner_options = { run_simulations: true, verbose: false, num_parallel: 7, max_to_run: Float::INFINITY })  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>run osws - running all scenario simulations</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>only_cb_modeled</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>used to only run the simulations for the cb_modeled (baseline) scenario</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>runner_options</span>
      
      
        <span class='type'>(<tt>hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ run_simulations: true, verbose: false, num_parallel: 7, max_to_run: Float::INFINITY }</tt>)</em>
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


496
497
498
499
500
501
502
503
504
505
506
507
508
509
510</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 496</span>

<span class='kw'>def</span> <span class='id identifier rubyid_run_osws'>run_osws</span><span class='lparen'>(</span><span class='id identifier rubyid_output_dir'>output_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_only_cb_modeled'>only_cb_modeled</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id identifier rubyid_runner_options'>runner_options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>run_simulations:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>verbose:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>num_parallel:</span> <span class='int'>7</span><span class='comma'>,</span> <span class='label'>max_to_run:</span> <span class='const'>Float</span><span class='op'>::</span><span class='const'>INFINITY</span> <span class='rbrace'>}</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_osw_files'>osw_files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='id identifier rubyid_osw_sr_files'>osw_sr_files</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
  <span class='kw'>if</span> <span class='id identifier rubyid_only_cb_modeled'>only_cb_modeled</span>
    <span class='id identifier rubyid_osw_files'>osw_files</span> <span class='op'>&lt;&lt;</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_cb_modeled'>cb_modeled</span><span class='period'>.</span><span class='id identifier rubyid_get_osw_dir'>get_osw_dir</span><span class='embexpr_end'>}</span><span class='tstring_content'>/in.osw</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>else</span>
    <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output_dir'>output_dir</span><span class='embexpr_end'>}</span><span class='tstring_content'>/**/in.osw</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_osw'>osw</span><span class='op'>|</span> <span class='id identifier rubyid_osw_files'>osw_files</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_osw'>osw</span> <span class='rbrace'>}</span>
  <span class='kw'>end</span>
  <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_glob'>glob</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_output_dir'>output_dir</span><span class='embexpr_end'>}</span><span class='tstring_content'>/SR/in.osw</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_osw'>osw</span><span class='op'>|</span> <span class='id identifier rubyid_osw_sr_files'>osw_sr_files</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_osw'>osw</span> <span class='rbrace'>}</span>

  <span class='id identifier rubyid_runner'>runner</span> <span class='op'>=</span> <span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Extension</span><span class='op'>::</span><span class='const'>Runner</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='id identifier rubyid_dirname'>dirname</span> <span class='op'>=</span> <span class='const'>Dir</span><span class='period'>.</span><span class='id identifier rubyid_pwd'>pwd</span><span class='comma'>,</span> <span class='id identifier rubyid_bundle_without'>bundle_without</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='id identifier rubyid_runner_options'>runner_options</span><span class='rparen'>)</span>

  <span class='comment'># This doesn&#39;t run the workflow defined by the Sizing Run
</span>  <span class='kw'>return</span> <span class='id identifier rubyid_runner'>runner</span><span class='period'>.</span><span class='id identifier rubyid_run_osws'>run_osws</span><span class='lparen'>(</span><span class='id identifier rubyid_osw_files'>osw_files</span> <span class='op'>-</span> <span class='id identifier rubyid_osw_sr_files'>osw_sr_files</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="set_argument_detail-instance_method">
  
    #<strong>set_argument_detail</strong>(workflow, argument, measure_dir_name, measure_name)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>TODO: Update this as I believe no longer will work as expected, keys being
searched for</p>

<pre class="code ruby"><code class="ruby">by the @facility_xml[&#39;key&#39;] don&#39;t make sense.
</code></pre>

<p>set argument details, used when the condition</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>workflow</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a hash of the openstudio workflow</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>argument</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>measure_dir_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the directory name for the measure, as it appears in any of the gems, i.e.
<a href="measure_dir_name">openstudio-common-measures-gem/lib/measures/</a></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>measure_name</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 368</span>

<span class='kw'>def</span> <span class='id identifier rubyid_set_argument_detail'>set_argument_detail</span><span class='lparen'>(</span><span class='id identifier rubyid_workflow'>workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_argument'>argument</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_name'>measure_name</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>
  <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_end'>&#39;</span></span>

  <span class='kw'>if</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Add daylight controls</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace HVAC system type to PZHP</span><span class='tstring_end'>&#39;</span></span>
    <span class='comment'># For these measures, the condition is based on the standards building type determined
</span>    <span class='kw'>if</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_building_type'>get_building_type</span>
      <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>

      <span class='comment'># This is a really terrible way to do this.  It fails
</span>      <span class='comment'># in many scenarios
</span>      <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span><span class='embexpr_end'>}</span><span class='tstring_content'> </span><span class='embexpr_beg'>#{</span><span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_standard_template'>get_standard_template</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace burner</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_system_type'>get_system_type</span>
      <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace boiler</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_system_type'>get_system_type</span>
      <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace package units</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_system_type'>get_system_type</span>
      <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>
      <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>elsif</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace HVAC system type to VRF</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace HVAC with GSHP and DOAS</span><span class='tstring_end'>&#39;</span></span> <span class='op'>||</span> <span class='id identifier rubyid_measure_name'>measure_name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Replace AC and heating units with ground coupled heat pump systems</span><span class='tstring_end'>&#39;</span></span>
    <span class='kw'>if</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:condition</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_site'>site</span><span class='period'>.</span><span class='id identifier rubyid_get_building_type'>get_building_type</span>
      <span class='id identifier rubyid_argument_name'>argument_name</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>
      <span class='id identifier rubyid_argument_value'>argument_value</span> <span class='op'>=</span> <span class='id identifier rubyid_argument'>argument</span><span class='lbracket'>[</span><span class='symbol'>:value</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>else</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.set_argument_detail</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>measure dir name not found </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_name'>measure_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.set_argument_detail: Measure dir name not found </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_measure_name'>measure_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>.</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_set_measure_argument'>set_measure_argument</span><span class='lparen'>(</span><span class='id identifier rubyid_workflow'>workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_measure_dir_name'>measure_dir_name</span><span class='comma'>,</span> <span class='id identifier rubyid_argument_name'>argument_name</span><span class='comma'>,</span> <span class='id identifier rubyid_argument_value'>argument_value</span><span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_argument_name'>argument_name</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_argument_name'>argument_name</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="setup_and_sizing_run-instance_method">
  
    #<strong>setup_and_sizing_run</strong>(dir, epw_file_path, standard_to_be_used, ddy_file = nil)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>generate the baseline model as osm model</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>epw_file_path</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>standard_to_be_used</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>&#39;ASHRAE90.1&#39; or &#39;CaliforniaTitle24&#39; are supported options</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ddy_file</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>path to the ddy file</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'></span>
      
      
      
        
        <div class='inline'>
<p>@see BuildingSync::Facility.write_osm</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


135
136
137
138
139
140</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 135</span>

<span class='kw'>def</span> <span class='id identifier rubyid_setup_and_sizing_run'>setup_and_sizing_run</span><span class='lparen'>(</span><span class='id identifier rubyid_dir'>dir</span><span class='comma'>,</span> <span class='id identifier rubyid_epw_file_path'>epw_file_path</span><span class='comma'>,</span> <span class='id identifier rubyid_standard_to_be_used'>standard_to_be_used</span><span class='comma'>,</span> <span class='id identifier rubyid_ddy_file'>ddy_file</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_set_all'>set_all</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_determine_open_studio_standard'>determine_open_studio_standard</span><span class='lparen'>(</span><span class='id identifier rubyid_standard_to_be_used'>standard_to_be_used</span><span class='rparen'>)</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_generate_baseline_osm'>generate_baseline_osm</span><span class='lparen'>(</span><span class='id identifier rubyid_epw_file_path'>epw_file_path</span><span class='comma'>,</span> <span class='id identifier rubyid_dir'>dir</span><span class='comma'>,</span> <span class='id identifier rubyid_standard_to_be_used'>standard_to_be_used</span><span class='comma'>,</span> <span class='id identifier rubyid_ddy_file'>ddy_file</span><span class='rparen'>)</span>
  <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_write_osm'>write_osm</span><span class='lparen'>(</span><span class='id identifier rubyid_dir'>dir</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_osw-instance_method">
  
    #<strong>write_osw</strong>(main_output_dir, scenario)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>Write an OSW for the provided scenario</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>main_output_dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>main output path, not scenario specific. i.e. SR should be a subdirectory</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'></span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Scenario.html" title="BuildingSync::Scenario (class)">BuildingSync::Scenario</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether the writing was successful</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 467</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write_osw'>write_osw</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_scenario'>scenario</span><span class='rparen'>)</span>
  <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>true</span>
  <span class='comment'># deep clone
</span>  <span class='id identifier rubyid_base_workflow'>base_workflow</span> <span class='op'>=</span> <span class='id identifier rubyid_deep_copy_workflow'>deep_copy_workflow</span>

  <span class='comment'># configure the workflow based on measures in this scenario
</span>  <span class='kw'>begin</span>
    <span class='comment'># The workflow is updated by configure_workflow, put with pass by reference
</span>    <span class='comment'># we are ok to use it later without returning
</span>    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_configure_workflow_for_scenario'>configure_workflow_for_scenario</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='comma'>,</span> <span class='id identifier rubyid_scenario'>scenario</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
      <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osw</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not configure workflow for scenario </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_xget_name'>xget_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_purge_skipped_from_workflow'>purge_skipped_from_workflow</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_set_workflow'>set_workflow</span><span class='lparen'>(</span><span class='id identifier rubyid_base_workflow'>base_workflow</span><span class='rparen'>)</span>
      <span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_write_osw'>write_osw</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='rparen'>)</span>
    <span class='kw'>end</span>
  <span class='kw'>rescue</span> <span class='const'>StandardError</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osw</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not configure for scenario </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_xget_name'>xget_name</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Error: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_e'>e</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Could not configure for scenario </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_xget_name'>xget_name</span><span class='embexpr_end'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='id identifier rubyid_e'>e</span><span class='period'>.</span><span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n\t</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='kw'>false</span>
  <span class='kw'>end</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_successful'>successful</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="write_osws-instance_method">
  
    #<strong>write_osws</strong>(main_output_dir, only_cb_modeled = false)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    
<p>write workflows for scenarios into osw files.  This includes:</p>

<pre class="code ruby"><code class="ruby">- Package of Measure Scenarios
- Current Building Modeled (Baseline) Scenario
</code></pre>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>main_output_dir</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>main output path, not scenario specific. i.e. SR should be a subdirectory</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>whether writing of all the new workflows was successful</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/buildingsync/makers/workflow_maker.rb', line 414</span>

<span class='kw'>def</span> <span class='id identifier rubyid_write_osws'>write_osws</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_only_cb_modeled'>only_cb_modeled</span> <span class='op'>=</span> <span class='kw'>false</span><span class='rparen'>)</span>
  <span class='comment'># make sure paths exist
</span>  <span class='const'>FileUtils</span><span class='period'>.</span><span class='id identifier rubyid_mkdir_p'>mkdir_p</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_cb_modeled'>cb_modeled</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>OSW cannot be written since no current building modeled scenario is defined. One can be added after file import using the add_cb_modeled method</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws: OSW cannot be written since no current building modeled scenario is defined. One can be added after file import using the add_cb_modeled method</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># Write a workflow for the current building modeled scenario
</span>  <span class='id identifier rubyid_cb_modeled_success'>cb_modeled_success</span> <span class='op'>=</span> <span class='id identifier rubyid_write_osw'>write_osw</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='comma'>,</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_cb_modeled'>cb_modeled</span><span class='rparen'>)</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_cb_modeled_success'>cb_modeled_success</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>A workflow was not successfully written for the cb_modeled (Current Building Modeled) Scenario.</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span> <span class='const'>StandardError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws: A workflow was not successfully written for the cb_modeled (Current Building Modeled) Scenario.</span><span class='tstring_end'>&#39;</span></span>
  <span class='kw'>end</span>

  <span class='id identifier rubyid_number_successful'>number_successful</span> <span class='op'>=</span> <span class='id identifier rubyid_cb_modeled_success'>cb_modeled_success</span> <span class='op'>?</span> <span class='int'>1</span> <span class='op'>:</span> <span class='int'>0</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_only_cb_modeled'>only_cb_modeled</span>
    <span class='comment'># write an osw for each Package Of Measures scenario
</span>    <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_poms'>poms</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_scenario'>scenario</span><span class='op'>|</span>
      <span class='id identifier rubyid_successful'>successful</span> <span class='op'>=</span> <span class='id identifier rubyid_write_osw'>write_osw</span><span class='lparen'>(</span><span class='id identifier rubyid_main_output_dir'>main_output_dir</span><span class='comma'>,</span> <span class='id identifier rubyid_scenario'>scenario</span><span class='rparen'>)</span>
      <span class='kw'>if</span> <span class='id identifier rubyid_successful'>successful</span>
        <span class='id identifier rubyid_number_successful'>number_successful</span> <span class='op'>+=</span> <span class='int'>1</span>
      <span class='kw'>else</span>
        <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Scenario ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_scenario'>scenario</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Unsuccessful write_osw</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
      <span class='kw'>end</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>

  <span class='comment'># Compare the total number of potential successes to the number of actual successes
</span>  <span class='kw'>if</span> <span class='id identifier rubyid_only_cb_modeled'>only_cb_modeled</span>
    <span class='comment'># In this case we should have only 1 success
</span>    <span class='id identifier rubyid_expected_successes'>expected_successes</span> <span class='op'>=</span> <span class='int'>1</span>
    <span class='id identifier rubyid_really_successful'>really_successful</span> <span class='op'>=</span> <span class='id identifier rubyid_number_successful'>number_successful</span> <span class='op'>==</span> <span class='id identifier rubyid_expected_successes'>expected_successes</span>
  <span class='kw'>else</span>
    <span class='comment'># In this case, all pom scenarios should be run + the cb_modeled scenario
</span>    <span class='id identifier rubyid_expected_successes'>expected_successes</span> <span class='op'>=</span> <span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_report'>report</span><span class='period'>.</span><span class='id identifier rubyid_poms'>poms</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>+</span> <span class='int'>1</span>
    <span class='id identifier rubyid_really_successful'>really_successful</span> <span class='op'>=</span> <span class='id identifier rubyid_number_successful'>number_successful</span> <span class='op'>==</span> <span class='id identifier rubyid_expected_successes'>expected_successes</span>
  <span class='kw'>end</span>

  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_really_successful'>really_successful</span>
    <span class='const'>OpenStudio</span><span class='period'>.</span><span class='id identifier rubyid_logFree'>logFree</span><span class='lparen'>(</span><span class='const'>OpenStudio</span><span class='op'>::</span><span class='const'>Error</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>BuildingSync.WorkflowMaker.write_osws</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Facility ID: </span><span class='embexpr_beg'>#{</span><span class='ivar'>@facility</span><span class='period'>.</span><span class='id identifier rubyid_xget_id'>xget_id</span><span class='embexpr_end'>}</span><span class='tstring_content'>. Expected </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_expected_successes'>expected_successes</span><span class='embexpr_end'>}</span><span class='tstring_content'>, Got </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_number_successful'>number_successful</span><span class='embexpr_end'>}</span><span class='tstring_content'> OSWs</span><span class='tstring_end'>&quot;</span></span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='kw'>return</span> <span class='id identifier rubyid_really_successful'>really_successful</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

      <div id="footer">
  Generated on Mon Sep 13 15:21:06 2021 by
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.9.26 (ruby-2.5.9).
</div>

    </div>
  </body>
</html>